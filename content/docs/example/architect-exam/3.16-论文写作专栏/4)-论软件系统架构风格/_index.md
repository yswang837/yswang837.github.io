---
weight: 4
title: 论软件系统架构风格
---

## 题目：论软件系统架构风格

&emsp;&emsp;软件体系结构风格是描述某一特定应用领域中系统组织方式的惯用模式。体系结构风格定义一个系统家族，即一个体系结构定义一个词汇表和一组约束。词汇表中包含一些构件和连接件类型，而这组约束指出系统是如何将这些构件和连接件组合起来的。体系结构风格反应了领域中众多系统所共有的结构和语义特性，并指导如何将各个模块和子系统有效地组织成一个完整的系统。

&emsp;&emsp;请围绕"论软件架构风格'论题，依次从以下三个方面进行论述。

&emsp;&emsp;1、概要叙述你参与分析和设计的软件系统开发项目以及你所担任的主要工作。

&emsp;&emsp;2、软件系统开发中常用的软件架构风格有哪些?详细阐述每种风格的具体含义。

&emsp;&emsp;3、详细说明你所参与分析和设计的软件系统是采用什么软件架构风格的，并分析采用该架构风格设计的原因。

---

## 摘要

&emsp;&emsp;我所在的国内某头部互联网公司，于2020年4月决定搭建一套全新的移动设备指纹分析处理平台项目，该项目的建设目标是为集团提供高效、可靠的移动设备指纹分析、存储及唯一标识移动设备能力，为公司各业务线的安全做好重要的底层支撑；我荣幸地担任本次系统开发的架构师，主要负责整个系统的架构设计、对项目的技术活动进行指导和协调。本文将以该项目为背景，着重介绍几种常见软件架构风格及其具体含义，同时详细探讨了数据流、调用/返回、独立构建风格如何在日活设备约2.6亿、峰值QPS达7万的项目中的实际应用。实践证明：恰当地组合使用架构风格，使得系统的开发取得了巨大的成功，目前系统已稳定运行1年多，赢得了亿级用户的一致好评。

## 正文

&emsp;&emsp;随着移动互联网技术的迅猛发展，包括手机、平板在内的移动设备已经成为人们生活中不可或缺的一部分，为我们带来了更便捷的信息获取和沟通方式。在这样的时代背景下，我就职的国内最大的社交媒体平台之一的公司，于2021年4月做出了一项决策：建设一个全新的移动设备指纹分析处理平台项目。该项目旨在给集团提供全面的移动设备指纹分析、存储和唯一标识移动设备的能力，为公司的多元化的业务体系提供坚实的底层支持。移动设备的广泛应用和迅速增长的用户基础使得此类系统的需求变得尤为迫切，在这样的挑战之下，我们面临着如何处理日活约2.6亿的移动设备指纹的读写、以及峰值QPS达7万的高并发场景下保持系统的高可用性。移动设备指纹指的是标识移动设备本身的信息，如系统版本、手机品牌等信息。

&emsp;&emsp;随着移动互联网技术的迅猛发展，包括手机、平板在内的移动设备已经成为人们生活中不可或缺的一部分，为我们带来了更便捷的信息获取和沟通方式。在这样的时代背景下，我就职的国内最大的社交媒体平台之一的公司，于2020年4月做出了一项决策：建设一个全新的移动设备指纹分析处理平台项目。该项目旨在给集团提供全面的移动设备指纹分析、存储和唯一标识移动设备的能力，为公司的多元化的业务体系提供坚实的底层支持。移动设备的广泛应用和迅速增长的用户基础使得此类系统的需求变得尤为迫切，在这样的挑战之下，我们面临着如何高效地处理日活约2.6亿的移动设备指纹、以及峰值QPS达7万的高并发场景下保持系统的高可用性。移动设备指纹指的是标识移动设备本身的信息，如CPU型号、系统版本、手机品牌、国际移动设备识别码IMEI等信息。

&emsp;&emsp;本文将深入探讨软件架构风格的实际应用。特别是，将重点介绍常见的软件架构风格及其具体含义，探讨数据流、调用/返回、独立构件风格等在日活设备约2.6亿、峰值QPS达7万的项目中的实际应用。

&emsp;&emsp;数据流风格包含顺序批处理和管道/过滤器子风格。顺序批处理适合于大量的整体的数据，无用户交互，典型应用有传统编译器和网络报文处理。管道/过滤器适合处理大量流式数据，弱用户交互。它们均由数据来进行驱动。

&emsp;&emsp;调用/返回风格包含主程序/子程序、面向对象和层次架构子风格。主程序/子程序风格是结构化程序设计的一种典型风格，它从功能的角度来设计系统，通过逐步分解和细化形成整个系统的架构。面向对象风格将系统看做是对象的集合，将数据的表示方法和它们对应的操作封装在一个对象中，对象之间通过函数调用来交互，这种风格包含了封装、继承和多态等重要特性。层次架构风格将信息系统进行分层，底层为上层提供服务，上层为底层提供驱动，修改当前层，最多只会影响紧挨的上下两层，这样做的好处在于将一个复杂的问题分解到各层去解决，保证了系统优良的可维护性和可扩展性。

&emsp;&emsp;独立构件风格包含进程通讯和隐式调用子风格。进程通讯风格将进程间的通信视为一种服务，可以通过共享内存、消息传递、远程过程调用等方式实现。隐式调用风格区别于调用返回风格，它的核心思想是通过事件的触发和处理来驱动系统的行为和交互。独立构建风格拥有较低的耦合性，强调通信的可靠性、安全性和效率性，同时还要考虑系统的可扩展性和可维护性，缺点在于放弃了对子程序的控制。

&emsp;&emsp;虚拟机风格包含解释器和规则系统子风格。解释器风格的软件通常包括解释引擎、存储源代码的区域、记录工作状态的数据结构以及记录执行进度的数据结构。这种风格的软件使用虚拟机来模拟硬件执行过程和关键应用。其缺点在于执行效率较低。规则系统风格则是在解释器风格上引入规则或者经验，典型的应用有专家系统。

&emsp;&emsp;仓库风格包括数据库系统和黑板系统两种子风格。仓库风格的软件元素分为两类：一种是资源库，也称为中央数据单元，用于表示系统的当前状态；另一种是相互依赖的构件组，这些构件可以对中央数据单元进行操作。中央数据单元和构件之间可以进行信息交换，这是实现数据共享体系结构的技术基础。根据控制策略的不同，数据共享体系结构可以分为两种类型：传统的数据库风格和黑板风格。如果系统的信息处理是由输入流中的事件驱动，并将执行结果存储到中央数据单元中，则这个系统属于数据库风格的应用系统。如果系统的运行是由中央数据单元的当前状态驱动，则这个系统属于黑板风格的应用系统。

&emsp;&emsp;过渡段，过渡到项目中是如何实际使用这些风格的

&emsp;&emsp;数据流风格在项目中的应用。考虑数据流风格要不要换成仓库风格。

&emsp;&emsp;调用/返回风格在项目中的应用。

&emsp;&emsp;独立构件风格在项目中的应用。

&emsp;&emsp;经历了一年半的开发，该项目于2022年10月成功上线，并且在过去的一年多时间里，系统架构稳定运行，实现了既定目标，赢得了过亿用户一致好评。虽然我们取得了这些成就，但也意识到了一些不足之处，特别是在自动化运维方面。这些挑战带给我们宝贵的经验和教训，为未来的工作提供了重要的参考，这正是我最大的收获。
